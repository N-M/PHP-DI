<!DOCTYPE html>
<!--[if lt IE 7]>
<html class="no-js lt-ie9 lt-ie8 lt-ie7"> <![endif]-->
<!--[if IE 7]>
<html class="no-js lt-ie9 lt-ie8"> <![endif]-->
<!--[if IE 8]>
<html class="no-js lt-ie9"> <![endif]-->
<!--[if gt IE 8]><!-->
<html class="no-js"> <!--<![endif]-->
<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
    <meta name="viewport" content="width=device-width, initial-scale=1">

    <title>PHP-DI - The Dependency Injection Container for humans</title>
    <meta name="description" content="PHP-DI is a Dependency Injection Container for PHP that intends to be practical and powerful.">

    <link rel="canonical" href="https://php-di.org" />

    <meta name="application-name" content="PHP-DI"/>
    <link rel="apple-touch-icon-precomposed" sizes="144x144" href="https://php-di.org/img/apple-touch-icon-144x144.png" />
    <link rel="apple-touch-icon-precomposed" sizes="152x152" href="https://php-di.org/img/apple-touch-icon-152x152.png" />
    <link rel="icon" type="image/png" href="https://php-di.org/img/favicon-32x32.png" sizes="32x32" />
    <link rel="icon" type="image/png" href="https://php-di.org/img/favicon-16x16.png" sizes="16x16" />
    <meta name="msapplication-TileColor" content="#484949" />
    <meta name="msapplication-TileImage" content="https://php-di.org/img/mstile-144x144.png" />

            <link href="https://fonts.googleapis.com/css?family=Abel:400|Oswald:300,400,700" media="all" rel="stylesheet" type="text/css">
        <link href="https://cdn.jsdelivr.net/docsearch.js/1/docsearch.min.css" rel="stylesheet">
        <link href="https://php-di.org/css/highlight.github.css" rel="stylesheet">
        <link href="https://php-di.org/css/all.min.css" rel="stylesheet">
    
    <script async defer data-domain="php-di.org" src="https://plausible.io/js/plausible.js"></script>
</head>
<body>

    <header>
        <div class="navbar navbar-default navbar-fixed-top">
            <div class="container">
                <div class="navbar-header">
                    <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#top-navigation">
                        <span class="sr-only">Toggle navigation</span>
                        <span class="icon-bar"></span>
                        <span class="icon-bar"></span>
                        <span class="icon-bar"></span>
                    </button>
                    <a class="navbar-brand" href="https://php-di.org/" title="Dependency injection container for PHP">PHP-DI</a>
                </div>
                <div class="navbar-form navbar-left hidden-xs hidden-sm">
                    <input id="search-input" type="text" class="form-control" placeholder="Search...">
                </div>
                <div class="collapse navbar-collapse" id="top-navigation">
                    <ul class="nav navbar-nav navbar-right">
                        <li><a href="https://php-di.org/doc/getting-started.html" title="Getting started with PHP-DI">Getting started</a></li>
                        <li><a href="https://php-di.org/doc/" title="PHP-DI documentation">Documentation</a></li>
                        <li><a href="https://php-di.org/support.html" title="Enterprise support for PHP-DI">For Enterprise</a></li>
                        <li><a href="https://php-di.org/news/" title="News about PHP-DI">News</a></li>
                        <li><a href="https://php-di.org/change-log.html" title="PHP-DI's changelog">Changelog</a></li>
                        <li><a class="github" href="https://github.com/PHP-DI/PHP-DI" title="PHP-DI on GitHub"><i class="fa fa-github"></i></a></li>
                    </ul>
                </div>
            </div>
        </div>
    </header>

    
    <div class="container documentation">

        <div class="sidebar">
            <ul>
                                    <li>
                        <span class="section-title">Introduction</span>

                        <ul>
                                                            <li class="">
                                    <a href="https://php-di.org/doc/getting-started.html">
                                        Getting started
                                    </a>
                                </li>
                                                            <li class="">
                                    <a href="https://php-di.org/doc/understanding-di.html">
                                        Understanding dependency injection
                                    </a>
                                </li>
                                                            <li class="">
                                    <a href="https://php-di.org/doc/best-practices.html">
                                        "Best practices" guide
                                    </a>
                                </li>
                                                    </ul>
                    </li>
                                    <li>
                        <span class="section-title">Usage</span>

                        <ul>
                                                            <li class="">
                                    <a href="https://php-di.org/doc/container-configuration.html">
                                        Configuring the container
                                    </a>
                                </li>
                                                            <li class="active">
                                    <a href="https://php-di.org/doc/container.html">
                                        Using the container
                                    </a>
                                </li>
                                                    </ul>
                    </li>
                                    <li>
                        <span class="section-title">Definitions</span>

                        <ul>
                                                            <li class="">
                                    <a href="https://php-di.org/doc/definition.html">
                                        Introduction
                                    </a>
                                </li>
                                                            <li class="">
                                    <a href="https://php-di.org/doc/autowiring.html">
                                        Autowiring
                                    </a>
                                </li>
                                                            <li class="">
                                    <a href="https://php-di.org/doc/php-definitions.html">
                                        PHP definitions
                                    </a>
                                </li>
                                                            <li class="">
                                    <a href="https://php-di.org/doc/attributes.html">
                                        PHP attributes
                                    </a>
                                </li>
                                                            <li class="">
                                    <a href="https://php-di.org/doc/annotations.html">
                                        Annotations
                                    </a>
                                </li>
                                                            <li class="">
                                    <a href="https://php-di.org/doc/definition-overriding.html">
                                        Definition extensions and overriding
                                    </a>
                                </li>
                                                    </ul>
                    </li>
                                    <li>
                        <span class="section-title">Frameworks</span>

                        <ul>
                                                            <li class="">
                                    <a href="https://php-di.org/doc/frameworks/slim.html">
                                        Slim
                                    </a>
                                </li>
                                                            <li class="">
                                    <a href="https://php-di.org/doc/frameworks/symfony2.html">
                                        Symfony
                                    </a>
                                </li>
                                                            <li class="">
                                    <a href="https://php-di.org/doc/frameworks/zf2.html">
                                        Zend Framework 2
                                    </a>
                                </li>
                                                            <li class="">
                                    <a href="https://php-di.org/doc/frameworks/zf1.html">
                                        Zend Framework 1
                                    </a>
                                </li>
                                                            <li class="">
                                    <a href="https://php-di.org/doc/frameworks/zend-expressive.html">
                                        Zend Expressive
                                    </a>
                                </li>
                                                            <li class="">
                                    <a href="https://php-di.org/doc/frameworks/silly.html">
                                        Silly
                                    </a>
                                </li>
                                                            <li class="">
                                    <a href="https://php-di.org/doc/frameworks/silex.html">
                                        Silex
                                    </a>
                                </li>
                                                            <li class="">
                                    <a href="https://github.com/PHP-DI/demo">
                                        Demo application
                                    </a>
                                </li>
                                                    </ul>
                    </li>
                                    <li>
                        <span class="section-title">Advanced topics</span>

                        <ul>
                                                            <li class="">
                                    <a href="https://php-di.org/doc/performances.html">
                                        Performances
                                    </a>
                                </li>
                                                            <li class="">
                                    <a href="https://php-di.org/doc/lazy-injection.html">
                                        Lazy injection
                                    </a>
                                </li>
                                                            <li class="">
                                    <a href="https://php-di.org/doc/inject-on-instance.html">
                                        Inject on an existing instance
                                    </a>
                                </li>
                                                            <li class="">
                                    <a href="https://php-di.org/doc/environments.html">
                                        Injections depending on the environment
                                    </a>
                                </li>
                                                            <li class="">
                                    <a href="https://php-di.org/doc/ide-integration.html">
                                        IDE integration
                                    </a>
                                </li>
                                                    </ul>
                    </li>
                                    <li>
                        <span class="section-title">Migration guides</span>

                        <ul>
                                                            <li class="">
                                    <a href="https://php-di.org/doc/migration/4.0.html">
                                        From PHP-DI 3.x to 4.0
                                    </a>
                                </li>
                                                            <li class="">
                                    <a href="https://php-di.org/doc/migration/5.0.html">
                                        From PHP-DI 4.x to 5.0
                                    </a>
                                </li>
                                                            <li class="">
                                    <a href="https://php-di.org/doc/migration/6.0.html">
                                        From PHP-DI 5.x to 6.0
                                    </a>
                                </li>
                                                            <li class="">
                                    <a href="https://php-di.org/doc/migration/7.0.html">
                                        From PHP-DI 6.x to 7.0
                                    </a>
                                </li>
                                                    </ul>
                    </li>
                                    <li>
                        <span class="section-title">Support</span>

                        <ul>
                                                            <li class="">
                                    <a href="https://php-di.org/support.html">
                                        Enterprise support
                                    </a>
                                </li>
                                                    </ul>
                    </li>
                                    <li>
                        <span class="section-title">Internals</span>

                        <ul>
                                                            <li class="">
                                    <a href="https://php-di.org/contributing.html">
                                        Contributing
                                    </a>
                                </li>
                                                            <li class="">
                                    <a href="https://php-di.org/doc/how-it-works.html">
                                        How PHP-DI works
                                    </a>
                                </li>
                                                    </ul>
                    </li>
                                    <li>
                        <span class="section-title">Old documentation</span>

                        <ul>
                                                            <li class="">
                                    <a href="https://github.com/PHP-DI/PHP-DI/tree/3.x/doc">
                                        PHP-DI 3.x
                                    </a>
                                </li>
                                                            <li class="">
                                    <a href="https://github.com/PHP-DI/PHP-DI/tree/4.x/doc">
                                        PHP-DI 4.x
                                    </a>
                                </li>
                                                            <li class="">
                                    <a href="https://github.com/PHP-DI/PHP-DI/tree/5.4/doc">
                                        PHP-DI 5.x
                                    </a>
                                </li>
                                                    </ul>
                    </li>
                            </ul>
        </div>

        <article>
            <div class="pull-right">
                <a href="https://github.com/PHP-DI/PHP-DI/blob/master/doc/container.md" class="btn btn-default btn-sm" title="Fork PHP-DI and improve the documentation via a pull request">
                    Edit this page on GitHub
                </a>
            </div>

            <h1 id="using-the-container">Using the container</h1>
<p>This documentation describes the API of the container object itself.</p>
<h2 id="get-amp-has">get() &amp; has()</h2>
<p>The container implements the <a href="http://www.php-fig.org/psr/psr-11/">PSR-11</a> standard. That means it implements <a href="https://github.com/php-fig/container/blob/master/src/ContainerInterface.php"><code>Psr\Container\ContainerInterface</code></a>:</p>
<pre><code class="language-php">namespace Psr\Container;

interface ContainerInterface
{
    public function get($id);
    public function has($id);
}</code></pre>
<p>You are encouraged to type-hint against this interface instead of the implementation (<code>DI\Container</code>) whenever possible. Doing so means your code is decoupled from PHP-DI and you can switch to another container anytime.</p>
<h2 id="set">set()</h2>
<p>You can set entries directly on the container:</p>
<pre><code class="language-php">$container-&gt;set('foo', 'bar');
$container-&gt;set('MyInterface', \DI\create('MyClass'));

// Use \DI\value if you need to set a closure as raw value,
// because closures are interpreted as factories by default
$container-&gt;set('myClosure', \DI\value(function() { /* ... */ }));</code></pre>
<p>However it is recommended to use definition files. See the <a href="definition.html">definition documentation</a>.</p>
<h2 id="make">make()</h2>
<p>The container also offers a <code>make()</code> method. This method is defined in <a href="https://github.com/PHP-DI/PHP-DI/blob/master/src/FactoryInterface.php"><code>DI\FactoryInterface</code></a>.</p>
<pre><code class="language-php">class GithubProfile
{
    public function __construct(ApiClient $client, $user)
    ...
}

$container-&gt;make('GithubProfile', [
    'user' =&gt; 'torvalds',
]);</code></pre>
<p>The <code>make()</code> method works like <code>get()</code> except <em>it will resolve the entry every time it is called</em>. Depending on the type of the entry this means:</p>
<ul>
<li>if the entry is an object, an new instance will be created every time</li>
<li>if the entry is a factory, the factory will be called every time</li>
<li>if the entry is an alias, the alias will be resolved every time</li>
</ul>
<p>Please note that only the entry you ask for will be resolved every time: all the dependencies of the entry will not! That means that if the entry is an alias, the entry the alias points to <em>will be resolved only once</em>.</p>
<p>If you provide parameters to <code>Container::make()</code> in the second argument, and if the entry to resolve is an object to create, the parameters provided will be used for the constructor of the object, and the missing parameters will be resolved from the container.</p>
<p><code>Container::make()</code> is useful for creating objects that should not be stored <em>inside</em> the container (i.e. that are not services, or that are not <a href="https://igor.io/2013/03/31/stateless-services.html"><strong>stateless</strong></a>), but that have dependencies. It is also useful if you want to override some parameters of an object's constructor.</p>
<p>If you need to use the <code>make()</code> method inside a service, or a controller, or whatever, it is recommended that you type-hint against <code>FactoryInterface</code>. That avoids coupling your code to the container. <code>DI\FactoryInterface</code> is automatically bound to <code>DI\Container</code> so you can inject it without any configuration.</p>
<h2 id="call">call()</h2>
<p>The container exposes a <code>call()</code> method that can invoke any PHP callable.</p>
<p>It offers the following additional features over using <code>call_user_func()</code>:</p>
<ul>
<li>
<p>named parameters (pass parameters indexed by name instead of position)</p>
<pre><code class="language-php">$container-&gt;call(function ($foo, $bar) {
    // ...
}, [
    'foo' =&gt; 'Hello',
    'bar' =&gt; 'World',
]);

// Can also be useful in a micro-framework for example
$container-&gt;call($controller, $_GET + $_POST);</code></pre>
</li>
<li>
<p>dependency injection based on the type-hinting</p>
<pre><code class="language-php">$container-&gt;call(function (Logger $logger, EntityManager $em) {
    // ...
});</code></pre>
</li>
<li>
<p>dependency injection based on explicit definition</p>
<pre><code class="language-php">$container-&gt;call(function ($dbHost) {
    // ...
}, [
    // Either indexed by parameter names
    'dbHost' =&gt; \DI\get('db.host'),
]);

$container-&gt;call(function ($dbHost) {
    // ...
}, [
    // Or not indexed
    \DI\get('db.host'),
]);</code></pre>
</li>
</ul>
<p>The best part is that you can mix all that:</p>
<pre><code class="language-php">$container-&gt;call(function (Logger $logger, $dbHost, $operation) {
    // ...
}, [
    'operation' =&gt; 'delete',
    'dbHost'    =&gt; \DI\get('db.host'),
]);</code></pre>
<p>The <code>call()</code> method is particularly useful to invoke controllers, for example:</p>
<pre><code class="language-php">$controller = function ($name, EntityManager $em) {
    // ...
}

$container-&gt;call($controller, $_GET); // $_GET contains ['name' =&gt; 'John']</code></pre>
<p>This leaves the liberty to the developer writing controllers to get request parameters
<em>and</em> services using dependency injection.</p>
<p>As with <code>make()</code>, <code>call()</code> is defined in <code>Invoker\InvokerInterface</code> (in the <a href="https://github.com/PHP-DI/Invoker">PHP-DI/Invoker package</a>) so that you can type-hint against that interface without coupling yourself to the container. <code>Invoker\InvokerInterface</code> is automatically bound to <code>DI\Container</code> so you can inject it without any configuration.</p>
<pre><code class="language-php">namespace Invoker;

interface InvokerInterface
{
    public function call($callable, array $parameters = []);
}</code></pre>
<p><code>Container::call()</code> can call any callable, that means:</p>
<ul>
<li>closures</li>
<li>functions</li>
<li>object methods and static methods</li>
<li>invokable objects (objects that implement <a href="http://php.net/manual/en/language.oop5.magic.php#object.invoke">__invoke()</a>)</li>
</ul>
<p>Additionally you can call:</p>
<ul>
<li>name of <a href="http://php.net/manual/en/language.oop5.magic.php#object.invoke">invokable</a> classes: <code>$container-&gt;call('My\CallableClass')</code></li>
<li>object methods (give the class name, not an object): <code>$container-&gt;call(['MyClass', 'someMethod'])</code></li>
</ul>
<p>In both case, <code>'My\CallableClass'</code> and <code>'MyClass'</code> will be resolved by the container using <code>$container-&gt;get()</code>.</p>
<p>That saves you from a more verbose form, for example:</p>
<pre><code class="language-php">$object = $container-&gt;get('My\CallableClass');
$container-&gt;call($object);

// can be written as
$container-&gt;call('My\CallableClass');</code></pre>
<h2 id="injecton">injectOn()</h2>
<p>Sometimes you want to inject dependencies on an object that is already created.</p>
<p>For example, some old frameworks don't allow you to control how controllers are created.
With <code>injectOn</code>, you can ask the container to fulfill the dependencies after the object is created.</p>
<p>Keep in mind it's usually always better to use <code>get()</code> or <code>make()</code> instead of <code>injectOn()</code>,
use it only where you really have to.</p>
<p>Example:</p>
<pre><code class="language-php">class UserController extends BaseController
{
    #[Inject]
    private SomeService $someService;

    public function __construct()
    {
        // The framework doesn't let us control how the controller is created, so
        // we can't use the container to create the controller
        // So we ask the container to inject dependencies
        $container-&gt;injectOn($this);

        // Now the dependencies are injected
        $this-&gt;someService-&gt;doSomething();
    }
}</code></pre>
<p>As you might have guessed, you can't use constructor injection with this method.
But other kind of injections (property or setter) will work, whether you use attributes
or whether you configured your object in a definition file.</p>
<h2 id="extending-the-container">Extending the container</h2>
<p>If you wish to delve into the container's internals, be aware that only the classes and interfaces tagged with the <code>@api</code> annotation are meant to be used by PHP-DI users.</p>
<p>All other classes and interfaces are internal classes, you may try to use them but backward compatibility is not guaranteed, even between minor versions.</p>
        </article>

    </div>


            <footer>
            <div class='container'>
                                    <p>
                        A question? Unsatisfied with the documentation?
                        <a href="https://github.com/PHP-DI/PHP-DI/issues/new">Open an issue</a>
                        or chat on
                        <a href="https://gitter.im/PHP-DI/PHP-DI" title="PHP-DI chat room">Gitter</a> or
                        <a href="https://twitter.com/phpdi" title="PHP-DI on Twitter">Twitter</a>.
                    </p>
                                <p>
                    <a href="https://twitter.com/share" class="twitter-share-button" data-related="PHPDI" data-dnt="true">Tweet</a>
                    <script>!function(d,s,id){var js,fjs=d.getElementsByTagName(s)[0],p=/^http:/.test(d.location)?'http':'https';if(!d.getElementById(id)){js=d.createElement(s);js.id=id;js.src=p+'://platform.twitter.com/widgets.js';fjs.parentNode.insertBefore(js,fjs);}}(document, 'script', 'twitter-wjs');</script>
                </p>
                <p>
                    By <a href="https://mnapoli.fr/" title="Software consulting and PHP news">Matthieu Napoli</a>
                    and <a href="https://github.com/PHP-DI/PHP-DI/graphs/contributors" title="PHP-DI contributors">contributors</a>
                    |
                    Website generated with
                    <a href="http://couscous.io" title="Static website generator for software documentation">Couscous</a>.
                </p>
                <p>
                    Want to support my work? Check out
                    <a href="https://serverless-visually-explained.com/?ref=php-di" title="Serverless course">Serverless Visually Explained</a>.
                </p>
            </div>
        </footer>
    
            <script src="https://php-di.org/bower_components/jquery/dist/jquery.min.js"></script>
        <script src="https://php-di.org/bower_components/bootstrap/dist/js/bootstrap.min.js"></script>
        <script src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/8.5/highlight.min.js"></script>

        <script>
            $(function() {
                hljs.initHighlightingOnLoad();

                // Add anchors to headers
                $('article h2, article h3, article h4, article h5').each(function () {
                    var url = document.URL.replace(/#.*$/, "") + '#' + $(this).attr('id');
                    $(this).append(' <a class="anchor" href="' + url + '">#</a>');
                });
            });
        </script>
    
    <script>
        var _gaq = _gaq || [];
        _gaq.push(['_setAccount', 'UA-15584647-13']);
        _gaq.push(['_trackPageview']);
        (function() {
            var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
            ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
            var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
        })();
    </script>

    <!-- Gitter -->
    <script>
        ((window.gitter = {}).chat = {}).options = {
            room: 'PHP-DI/PHP-DI'
        };
    </script>
    <script src="https://sidecar.gitter.im/dist/sidecar.v1.js" async defer></script>

    <script type="text/javascript" src="https://cdn.jsdelivr.net/docsearch.js/1/docsearch.min.js"></script>
    <script type="text/javascript">
        $(function () {
            var search = docsearch({
                apiKey: 'ef6af24cbacae1f85d3c44741df49167',
                indexName: 'php-di',
                inputSelector: '#search-input'
            });
            var delay = (function () {
                var timer = 0;
                return function (callback, ms) {
                    clearTimeout(timer);
                    timer = setTimeout(callback, ms);
                };
            })();
            search.autocomplete.on('autocomplete:selected', function (e, suggestion) {
                var articleTitle = suggestion.subcategory;
                // Strip HTML tags
                var div = document.createElement("div");
                div.innerHTML = articleTitle;
                articleTitle = div.textContent || div.innerText || "";
                _gaq.push(['_trackEvent', 'search', 'click', articleTitle]);
            });
            $('#search-input').bind('input', function () {
                var search = $(this).val();
                if (search.length < 3) {
                    return;
                }
                delay(function () {
                    _gaq.push(['_trackPageview', '/search?q=' + search]);
                }, 600);
            });
        });
    </script>

</body>
</html>
